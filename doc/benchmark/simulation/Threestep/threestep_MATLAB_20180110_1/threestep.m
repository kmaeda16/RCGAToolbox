function ydot = threestep(t,y,param)

G1 = y(1);
G2 = y(2);
G3 = y(3);
E1 = y(4);
E2 = y(5);
E3 = y(6);
M1 = y(7);
M2 = y(8);

S     = param( 1); % 0.1  (model input) % Fixed
P     = param( 2); % 0.05 (model input) % Fixed
V1    = param( 3); % 1   % 10^-12 -- 10^+6
Ki1   = param( 4); % 1   % 10^-12 -- 10^+6
ni1   = param( 5); % 2   % 10^-1  -- 10^+1
Ka1   = param( 6); % 1   % 10^-12 -- 10^+6
na1   = param( 7); % 2   % 10^-1  -- 10^+1
k1    = param( 8); % 1   % 10^-12 -- 10^+6
V2    = param( 9); % 1   % 10^-12 -- 10^+6
Ki2   = param(10); % 1   % 10^-12 -- 10^+6
ni2   = param(11); % 2   % 10^-1  -- 10^+1
Ka2   = param(12); % 1   % 10^-12 -- 10^+6
na2   = param(13); % 2   % 10^-1  -- 10^+1
k2    = param(14); % 1   % 10^-12 -- 10^+6
V3    = param(15); % 1   % 10^-12 -- 10^+6
Ki3   = param(16); % 1   % 10^-12 -- 10^+6
ni3   = param(17); % 2   % 10^-1  -- 10^+1
Ka3   = param(18); % 1   % 10^-12 -- 10^+6
na3   = param(19); % 2   % 10^-1  -- 10^+1
k3    = param(20); % 1   % 10^-12 -- 10^+6
V4    = param(21); % 0.1 % 10^-12 -- 10^+6
K4    = param(22); % 1   % 10^-12 -- 10^+6
k4    = param(23); % 0.1 % 10^-12 -- 10^+6
V5    = param(24); % 0.1 % 10^-12 -- 10^+6
K5    = param(25); % 1   % 10^-12 -- 10^+6
k5    = param(26); % 0.1 % 10^-12 -- 10^+6
V6    = param(27); % 0.1 % 10^-12 -- 10^+6
K6    = param(28); % 1   % 10^-12 -- 10^+6
k6    = param(29); % 0.1 % 10^-12 -- 10^+6
kcat1 = param(30); % 1   % 10^-12 -- 10^+6
Km1   = param(31); % 1   % 10^-12 -- 10^+6
Km2   = param(32); % 1   % 10^-12 -- 10^+6
kcat2 = param(33); % 1   % 10^-12 -- 10^+6
Km3   = param(34); % 1   % 10^-12 -- 10^+6
Km4   = param(35); % 1   % 10^-12 -- 10^+6
kcat3 = param(36); % 1   % 10^-12 -- 10^+6
Km5   = param(37); % 1   % 10^-12 -- 10^+6
Km6   = param(38); % 1   % 10^-12 -- 10^+6

G1_dot = V1 / ( 1 + power( P / Ki1, ni1 ) + power( Ka1 / S,  na1) ) - k1 * G1;
G2_dot = V2 / ( 1 + power( P / Ki2, ni2 ) + power( Ka2 / M1, na2) ) - k2 * G2;
G3_dot = V3 / ( 1 + power( P / Ki3, ni3 ) + power( Ka3 / M2, na3) ) - k3 * G3;
E1_dot = V4 * G1 / ( K4 + G1 ) - k4 * E1;
E2_dot = V5 * G2 / ( K5 + G2 ) - k5 * E2;
E3_dot = V6 * G3 / ( K6 + G3 ) - k6 * E3;
M1_dot = kcat1 * E1 * ( 1 / Km1 ) * ( S  - M1 ) / ( 1 +  S / Km1 + M1 / Km2 ) ...
    - kcat2 * E2 * ( 1 / Km3 ) * ( M1 - M2 ) / ( 1 + M1 / Km3 + M2 / Km4 );
M2_dot = kcat2 * E2 * ( 1 / Km3 ) * ( M1 - M2 ) / ( 1 + M1 / Km3 + M2 / Km4 ) ...
    - kcat3 * E3 * ( 1 / Km5 ) * ( M2 - P  ) / ( 1 + M2 / Km5 + P  / Km6 );

ydot = zeros(8,1);
ydot(1) = G1_dot;
ydot(2) = G2_dot;
ydot(3) = G3_dot;
ydot(4) = E1_dot;
ydot(5) = E2_dot;
ydot(6) = E3_dot;
ydot(7) = M1_dot;
ydot(8) = M2_dot;

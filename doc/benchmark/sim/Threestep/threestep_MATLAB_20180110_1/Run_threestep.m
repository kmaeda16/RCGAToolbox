tic

T0 = 0;
Tend = 120;
Intvl = 0.2;

options = odeset('RelTol',1e-6,'AbsTol',1e-6);

%% Three-step model
drivsfun = @threestep;

S     = 0.1;  % (model input) Fixed
P     = 0.05; % (model input) Fixed
V1    = 1;    % 10^-12 -- 10^+6
Ki1   = 1;    % 10^-12 -- 10^+6
ni1   = 2;    % 10^-1  -- 10^+1
Ka1   = 1;    % 10^-12 -- 10^+6
na1   = 2;    % 10^-1  -- 10^+1
k1    = 1;    % 10^-12 -- 10^+6
V2    = 1;    % 10^-12 -- 10^+6
Ki2   = 1;    % 10^-12 -- 10^+6
ni2   = 2;    % 10^-1  -- 10^+1
Ka2   = 1;    % 10^-12 -- 10^+6
na2   = 2;    % 10^-1  -- 10^+1
k2    = 1;    % 10^-12 -- 10^+6
V3    = 1;    % 10^-12 -- 10^+6
Ki3   = 1;    % 10^-12 -- 10^+6
ni3   = 2;    % 10^-1  -- 10^+1
Ka3   = 1;    % 10^-12 -- 10^+6
na3   = 2;    % 10^-1  -- 10^+1
k3    = 1;    % 10^-12 -- 10^+6
V4    = 0.1;  % 10^-12 -- 10^+6
K4    = 1;    % 10^-12 -- 10^+6
k4    = 0.1;  % 10^-12 -- 10^+6
V5    = 0.1;  % 10^-12 -- 10^+6
K5    = 1;    % 10^-12 -- 10^+6
k5    = 0.1;  % 10^-12 -- 10^+6
V6    = 0.1;  % 10^-12 -- 10^+6
K6    = 1;    % 10^-12 -- 10^+6
k6    = 0.1;  % 10^-12 -- 10^+6
kcat1 = 1;    % 10^-12 -- 10^+6
Km1   = 1;    % 10^-12 -- 10^+6
Km2   = 1;    % 10^-12 -- 10^+6
kcat2 = 1;    % 10^-12 -- 10^+6
Km3   = 1;    % 10^-12 -- 10^+6
Km4   = 1;    % 10^-12 -- 10^+6
kcat3 = 1;    % 10^-12 -- 10^+6
Km5   = 1;    % 10^-12 -- 10^+6
Km6   = 1;    % 10^-12 -- 10^+6

% S = 0.1;     P = 0.05;    % Experiment 1
% S = 0.46416; P = 0.05;    % Experiment 2
% S = 2.1544;  P = 0.05;    % Experiment 3
% S = 10;      P = 0.05;    % Experiment 4
% S = 0.1;     P = 0.13572; % Experiment 5
% S = 0.46416; P = 0.13572; % Experiment 6
% S = 2.1544;  P = 0.13572; % Experiment 7
% S = 10;      P = 0.13572; % Experiment 8
% S = 0.1;     P = 0.36840; % Experiment 9
% S = 0.46416; P = 0.36840; % Experiment 10
% S = 2.1544;  P = 0.36840; % Experiment 11
% S = 10;      P = 0.36840; % Experiment 12
% S = 0.1;     P = 1.0;     % Experiment 13
% S = 0.46416; P = 1.0;     % Experiment 14
% S = 2.1544;  P = 1.0;     % Experiment 15
% S = 10;      P = 1.0;     % Experiment 16

G1 = 0.66667;
G2 = 0.57254;
G3 = 0.41758;
E1 = 0.4;
E2 = 0.36409;
E3 = 0.29457;
M1 = 1.419;
M2 = 0.93464;

y0 = [ G1; G2; G3; E1; E2; E3; M1; M2 ];

%%
param = [ S, P, ... % 1 - 2
    V1, Ki1, ni1, Ka1, na1, k1, ... %  3 -  8
    V2, Ki2, ni2, Ka2, na2, k2, ... %  9 - 14
    V3, Ki3, ni3, Ka3, na3, k3, ... % 15 - 20
    V4, K4, k4, ... % 21 - 23
    V5, K5, k5, ... % 24 - 26
    V6, K6, k6, ... % 27 - 29
    kcat1, Km1, Km2, ... % 30 - 32
    kcat2, Km3, Km4, ... % 33 - 35
    kcat3, Km5, Km6 ];   % 36 - 38

f = @(t,y)drivsfun(t,y,param);
[T, Y] = ode15s(f,T0:Intvl:Tend,y0,options);

figure;
plot(T,Y);
legend('G_1','G_2','G_3','E_1','E_2','E_3','M_1','M_2');
xlabel('Time');
ylabel('Concentration');
% ylim([0 1]);

toc
